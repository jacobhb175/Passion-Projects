<!DOCTYPE html>
<html>
  <head><title>Science Fair Sim - Cacao Tree</title></head>
  <body>
    <body background="https://www.flavoursplace.com/images/detailed/1/Raw_cacao_beans.jpg">
    <center><h2>Cacao Tree Simulation</h2>
    <button onclick="newGame()"type="button">New Game</button>
    <button onclick="nextTurn()"type="button">Next Turn</button></center>
    <p>Evolution Points: <span id="evoPoints"></span><p>
    <p>Variety: <span id="variety"></span></p>
    <p>Age: <span id="age"></span><p>
    <p>Farm Wealth: <span id="farmWealth"></span><p>
    <p><button onclick="improve(Yield)"type="button">+1</button> Yield: <span id="Yield"></span></p>
    <p><button onclick="improve(taste)"type="button">+1</button> Taste: <span id="taste"></span></p>
    <p><button onclick="improve(def)"type="button">+1</button> Defense: <span id="def"></span></p>
    <p><button onclick="improve(con)"type="button">+1</button> Constitution: <span id="con"></span></p>
    <p><button onclick="improve(maxHP)"type="button">+1</button> Health: <span id="health"></span></p>
    <p><button onclick="regen()"type="button">+1</button> Health Regeneration: <span id="regen"></span></p>
    <p><button onclick="res()"type="button">Disease Resistance</button></p>
    <style>
    </style>
    <script>
      let age = 0;
      let evoPoints = 0;
      let Yield = 0;
      let taste = 0;
      let def = 0;
      let con = 0;
      let maxHP = 0;
      let HP = 0;
      let farmWealth = 10;
      let event;
      let status;
      let disRes = false;
      let HPregen = 1;

      function newGame() {
        let variety = prompt("Forastero, Trinitario, or Criollo");
        variety = variety.toUpperCase();
        if (variety=="CRIOLLO") {
          document.getElementById('variety').innerHTML = "Criollo";
          Yield = 50;
          taste = 100;
          def = 50;
          con = 50;
          maxHP = 50;
        }
        else if (variety=="TRINITARIO") {
          document.getElementById('variety').innerHTML = "Trinitario";
          Yield = 70;
          taste = 60;
          def = 50;
          con = 70;
          maxHP = 50;
      }
      else {
        document.getElementById('variety').innerHTML = "Forasterero";
        Yield = 70;
        taste = 40;
        def = 70;
        con = 70;
        maxHP = 50;
      }
      HP = maxHP;
    }

      function update() {
        document.getElementById('evoPoints').innerHTML = evoPoints;
        document.getElementById('Yield').innerHTML = Yield;
        document.getElementById('taste').innerHTML = taste;
        document.getElementById('def').innerHTML = def;
        document.getElementById('con').innerHTML = con;
        document.getElementById('health').innerHTML = HP+"/"+maxHP;
        document.getElementById('age').innerHTML = age;
        document.getElementById('farmWealth').innerHTML = farmWealth;
        document.getElementById('regen').innerHTML = HPregen;
      }

      function nextTurn() {
        farmWealth = farmWealth + Math.floor(Math.random() * (Yield+taste/20) + 1);
        if (HP<maxHP) {
          HP = HP + HPregen;
        }
        age += 5;
        evoPoints += 5;
        if (age >= 60) {
          alert("Your productivity has delined and you have been chopped down. Game Over. Score: "+Math.Floor(evoPoints+age+farmWealth/10+Yield/10+taste/10+def/10+con/10+HP/10+maxHP/10+disRes));
        }
        eventGen();
        switch (event) {
          case "FPR":
            if(def <= 90&&disRes!=10){
              status = "infected";
            }
            break;
          case "drought":
            HP = HP - Math.floor((Math.random() * (15-con/10) + 1));
            con = con - Math.floor(con/10);
            break;
          case "pests":
            HP = HP - Math.floor((Math.random() * (20-def/10) + 1));
            Yield = Yield - Math.floor(Yield/10-def/20);
            break;
          case "deforest":
            con = con - Math.floor((Math.random() * (15-con/10) + 1));
            def = def - Math.floor(def/15)
            HP = HP - 5;
        }
        if (status == "infected") {
          HP = HP - 25;
        }
        farmInt();
        update();
        if (HP<=0){
          alert("You have died. Game Over. Score : "+Math.floor(evoPoints+age+farmWealth/10+Yield/10+taste/10+def/10+con/10+HP/10+maxHP/10+disRes));
        }
        event = "";
      }

      function improve(value) {
        if (evoPoints>0) {
          if (value<100) {
            switch (value) {
              case Yield:
                Yield += 1;
                break;
              case taste:
                taste += 1;
                break;
              case def:
                def += 1;
                break;
              case con:
                con += 1;
                break;
              case maxHP:
                maxHP += 1;
                break;
          }
          evoPoints -= 1;
          update();
        }
        else {
          alert("This stat is already max level.")
        }
      }
        else {
          alert("You do not have enough Evolution Points to improve this.");
        }
      }

      function eventGen() {
        let x = Math.floor((Math.random() * 25) + 1);
        switch (x) {
          case 1:
            alert("Outbreak of Frosty Pod Rot!")
            event = "FPR";
            break;
          case 2:
          case 3:
            alert("Drought!")
            event = "drought";
            break;
          case 4:
          case 5:
            alert("Mirid attack!")
            event = "pests";
            break;
          case 6:
          case 7:
            alert("Deforestation!")
            event = "deforest";
            break;
          case 8:
          case 9:
          case 10:
          case 11:
            alert("Poor harvest!")
            farmWealth = farmWealth - 20;
            break;
        }
      }

      function farmInt() {
        let y = Math.floor((Math.random() * 75 + 1 + Math.floor(farmWealth/10)));
        if (y>=75){
          alert("The farm owner gives you support.")
          let z = Math.floor((Math.random() * 6 + 1))
          switch (z) {
            case 1:
              Yield+=5;
              break;
            case 2:
              taste+=5;
              break;
            case 3:
              def+=5;
              break;
            case 4:
              con+=5;
              break;
            case 5:
              maxHP+=5;
              break;
            case 6:
              HPregen+=2;
              break;
          }
        }
      }
      function res() {
          if(evoPoints>=10&&def>=60){
            evoPoints -= 10;
            disRes = 10;
            status = "";
            update();
          }
          else if (def<60) {
            alert("You need at least 60 Defense before you can evolve Disease Resistance.")
          }
          else {
            alert("You need 10 Evolution Points to evolve Disease Resistance.")
          }
      }
      function regen() {
        if (evoPoints>=2){
          evoPoints = evoPoints - 2;
          HPregen = HPregen + 1;
          update();
        }
      }
    </script>
  </body>
</html>
